# モジュール4: Microsoft Purview によるコンプライアンスの管理 (試験比重: 15-20%)

## はじめに (モジュール4の学習を始めるにあたって)

このモジュールでは、組織のコンプライアンス要件を満たし、データを保護し、リスクを管理するための Microsoft Purview ソリューション群について学習します。機密情報の特定と保護、データのライフサイクル管理、データ損失防止、内部関係者のリスク管理、コミュニケーションの監視、法的な調査のための電子情報開示、そして監査ログの活用方法など、広範なトピックを扱います。これらの機能を理解し、適切に構成・運用することは、現代の組織にとって不可欠です。

**学習目標:**

* Microsoft Purview の概要と、コンプライアンス管理における役割を理解する。
* 秘密度ラベルを使用して、機密情報を分類し、保護（暗号化、コンテンツマーキングなど）する方法を習得する。
* データライフサイクル管理（アイテム保持ポリシー、アイテム保持ラベル）を構成し、データの保持と削除を自動化する方法を理解する。
* データ損失防止 (DLP) ポリシーを作成し、機密情報が組織外に不正に送信されるのを防ぐ方法を習得する。
* インサイダーリスク管理ソリューションを使用して、内部関係者による潜在的なリスクを特定し、管理する方法を理解する。
* コミュニケーションコンプライアンスを使用して、組織内のコミュニケーションにおけるポリシー違反を検出し、レビューする方法を理解する。
* 電子情報開示 (eDiscovery) ツールを使用して、法的な調査や内部調査のために必要なデータを検索、収集、レビューする方法を習得する。
* Microsoft Purview 監査ログを活用して、ユーザーおよび管理者のアクティビティを追跡し、調査する方法を理解する。

---

## 4.1 情報保護 (Microsoft Purview Information Protection - 秘密度ラベル)

### 情報保護の重要性

* **背景**: データは組織の最も重要な資産の一つです。データ侵害や情報漏洩は、経済的損失、法的責任、評判の失墜など、深刻な結果をもたらす可能性があります。
* **目的**: 機密性の高い情報（個人情報、財務データ、知的財産など）を特定し、その機密度に応じて分類し、適切な保護（アクセス制御、暗号化、視覚的なマーキングなど）を適用することで、情報がどこにあっても（エンドポイント、アプリ、クラウドサービス、オンプレミス）一貫して保護されるようにします。
* **ゼロトラストモデルとの関連**: 「常に検証する」「最小権限アクセスを適用する」「侵害を想定する」というゼロトラストの原則に基づき、データ自体にセキュリティを組み込みます。

### 秘密度ラベル (Sensitivity Labels) の概要

* **定義**: ドキュメントやメール、さらにはTeamsサイトやMicrosoft 365グループなどのコンテナーに対して適用できる「ラベル」であり、そのコンテンツの機密度を示します。
* **機能**: ラベルに紐づけて、以下のような保護設定を適用できます。
    * **暗号化**: 特定のユーザーやグループのみがコンテンツを復号化（閲覧・編集）できるようにします。Azure Information Protection (Azure RMS) の暗号化技術を利用します。
    * **コンテンツマーキング**: ドキュメントやメールに透かし、ヘッダー、フッターを追加し、機密度を視覚的に示します。
    * **エンドポイントでのDLP連携**: ラベルが付いたアイテムの取り扱いを制御します（コピー、印刷、外部共有のブロックなど。詳細はDLPセクションで）。
    * **コンテナーへの適用 (Microsoft 365 グループ、Teamsサイト、SharePointサイト)**:
        * プライバシー設定（パブリック/プライベート）。
        * 外部ユーザーアクセスや共有の制限。
        * アンマネージドデバイスからのアクセス制限。
* **ラベルの階層と順序**: ラベルは機密度のレベルに応じて階層的に定義できます（例: 個人用 < 一般 < Confidential < Highly Confidential）。順序が重要で、より制限の厳しいラベルが優先されることがあります。
    * `[図：秘密度ラベルの階層構造の例]`

### 秘密度ラベルの作成と構成

* **アクセス場所**: Microsoft Purview コンプライアンスポータル (`compliance.microsoft.com`) > `[情報保護]` > `[ラベル]`。
    * `[スクリーンショット：秘密度ラベル一覧画面]`
* **作成ウィザードの主要ステップ**:
    1.  **名前と説明**: ラベル名（ユーザーに表示される）と、管理者向けの説明。
    2.  **スコープの定義**:
        * **アイテム**: ファイル、メール。
            * **ファイルとメールの暗号化**: 暗号化を有効にするか。
                * アクセス許可の割り当て: 特定のユーザー/グループに権限（閲覧者、共同編集者、所有者など）を割り当てるか、事前定義された権限（例: 全従業員 - 読み取り専用）を使用するか。
                * コンテンツの有効期限やオフラインアクセス制御も設定可能。
            * **コンテンツマーキング**: 透かし、ヘッダー、フッターのテキストと書式。
        * **グループとサイト (コンテナー)**: Microsoft 365 グループ、Teamsサイト、SharePointサイトに適用。
            * プライバシーと外部ユーザーアクセス設定。
            * 外部共有設定。
            * デバイスアクセス設定（アンマネージドデバイスからのアクセス制限）。
        * **スキーマ化されたデータ資産 (プレビュー)**: Azure Purview (現Microsoft Purview Data Map) との連携。
    3.  **自動ラベル付け (Auto-labeling for files and emails)**: (Premiumライセンスが必要な場合あり)
        * **クライアントサイド (Officeアプリ内)**: ユーザーがドキュメントやメールを作成・編集する際に、機密情報の種類（クレジットカード番号、個人識別情報など）やキーワードに基づいて、ラベルの適用を推奨、または自動的に適用します。
        * **サービスサイド (データストア内)**: SharePoint Online、OneDrive for Business、Exchange Onlineに保存されている既存のデータや新規データをスキャンし、条件に一致する場合に自動的にラベルを適用します。
            * **ポリシーの作成**: 自動ラベル付けポリシーを作成し、対象の場所、条件、適用するラベルを指定します。
            * シミュレーションモード: ポリシーを実際に適用する前に、どの程度のファイルにラベルが付与されるかをシミュレーションできます。
        * `[スクリーンショット：秘密度ラベルの自動ラベル付け条件設定画面]`
    4.  **DLPポリシーでの使用定義**: (参考) ラベルをDLPポリシーの条件として使用できます。
    5.  **グループとサイトの設定**: スコープで選択した場合の詳細設定。
    6.  **Power BIコンテンツの保護**: (参考) Power BIのコンテンツにもラベルを適用できます。
* **ラベルポリシーの発行**: 作成したラベルをユーザーが利用できるようにするには、ラベルポリシーを作成し、対象のユーザーやグループに発行する必要があります。
    * ポリシーで、デフォルトラベル、必須ラベル付け、ユーザーによるラベル変更の正当化要求などを設定できます。
    * `[スクリーンショット：秘密度ラベルポリシーの発行設定画面]`

### 秘密度ラベルの適用とユーザーエクスペリエンス

* **手動適用**: Officeアプリケーション（Word, Excel, PowerPoint, Outlook）のリボンに表示される「秘密度」ボタンから、ユーザーが適切なラベルを選択して適用します。
    * `[スクリーンショット：Officeアプリリボンでの秘密度ラベル選択の様子]`
* **推奨ラベル**: 自動ラベル付け（クライアントサイド）が構成されている場合、コンテンツに基づいてラベルが推奨され、ユーザーはワンクリックで適用できます。
* **自動適用**: 条件に完全に一致する場合、ユーザーの操作なしに自動的にラベルが適用されることもあります。
* **適用後の動作**:
    * コンテンツマーキングが表示されます。
    * 暗号化が適用されていれば、許可されたユーザーのみがコンテンツにアクセスできます。
    * TeamsサイトやSharePointサイトにラベルが適用されていれば、その設定（プライバシー、外部共有など）が強制されます。

### ハンズオン演習アイデア

* **演習4.1: 秘密度ラベルの作成 (基本)**
    1.  Microsoft Purview コンプライアンスポータルで、以下の2つの秘密度ラベルを作成する。
        * **ラベル1**: 名前「Internal」、説明「社内向けの一般情報」、コンテンツマーキングなし、暗号化なし。
        * **ラベル2**: 名前「Confidential」、説明「社外秘情報」、コンテンツマーキング（フッターに「CONFIDENTIAL」と表示）、暗号化（組織内の全ユーザーに閲覧許可）。
    2.  作成したラベルを含むラベルポリシーを作成し、テストユーザーに発行する。
* **演習4.2: 秘密度ラベルの手動適用と効果の確認**
    1.  テストユーザーでWordドキュメントを作成する。
    2.  「秘密度」ボタンから「Internal」ラベルを適用し、特に変化がないことを確認する。
    3.  次に「Confidential」ラベルを適用し、フッターに「CONFIDENTIAL」と表示され、ドキュメントが保護（暗号化）されることを確認する（ファイルプロパティなど）。
    4.  別のテストユーザー（同じ組織内）でそのファイルを開けることを確認する。
    5.  (可能であれば) 組織外のユーザーアカウントでそのファイルを開こうとし、アクセスできないことを確認する。
* **演習4.3: 自動ラベル付けポリシーの作成 (クライアントサイド推奨 - シミュレーション)**
    1.  「クレジットカード番号」の機密情報の種類を検出した場合に、「Confidential」ラベルの適用を推奨する自動ラベル付けポリシー（クライアントサイド）の設定項目を確認する。
    2.  Wordドキュメントにダミーのクレジットカード番号を入力し、ラベルが推奨される（または自動適用される）動作を体験する（ライセンスと設定による）。

---

## 4.2 データライフサイクル管理 (Microsoft Purview Data Lifecycle Management - 旧称 Microsoft Information Governance)

### データライフサイクル管理の概要と目的

* **目的**: 組織の法的要件、コンプライアンス規制、ビジネスニーズに基づいて、データの作成から保存、最終的な廃棄（または永続的な保持）までのライフサイクル全体を管理します。
* **主な機能**:
    * **データの保持 (Retention)**: 必要な期間、データを保持し、誤った削除や改ざんを防ぎます。
    * **データの削除 (Deletion)**: 不要になったデータを適切に削除し、ストレージコストの削減やリスクの低減を図ります。
    * **不変ストレージ (Immutable storage)**: 特定の期間、データを変更・削除できないようにロックします（規制対応など）。
* **対象**: Exchange Onlineメール、SharePoint Onlineドキュメント、OneDrive for Businessファイル、Microsoft Teamsメッセージ、Yammerメッセージなど。

### アイテム保持ポリシー (Retention Policies)

* **目的**: 広範囲のコンテンツ（サイト全体、メールボックス全体、特定の場所など）に対して、統一的な保持・削除ルールを適用します。
* **動作の仕組み**:
    * ポリシーで指定した期間、コンテンツを保持します。ユーザーがアイテムを削除しても、バックグラウンドで「回復可能なアイテム」フォルダーや「Preservation Hold Library」にコピーが保持されます。
    * 保持期間終了後、コンテンツを自動的に削除するか、何もしないか（手動削除待ち）、またはレビューをトリガーするかを設定できます。
* **設定項目**:
    * **名前と説明**。
    * **割り当ての種類**:
        * **アダプティブスコープ (Adaptive Scope)**: (Premium機能) ユーザー属性、サイトプロパティ、Microsoft 365グループ属性などに基づいて、ポリシーの適用対象を動的に決定します。非常に柔軟性が高い。
        * **静的スコープ (Static Scope)**: 特定の場所（全Exchangeメールボックス、特定のSharePointサイトなど）や、特定のユーザー/グループを選択します。
    * **場所**: Exchangeメール、SharePointサイト、OneDriveアカウント、Microsoft 365グループ、Teamsチャット/チャネルメッセージ、Skype for Business、Exchangeパブリックフォルダー、Yammerメッセージ。
        * `[スクリーンショット：保持ポリシーの場所の選択画面]`
    * **保持設定**:
        * **特定の期間アイテムを保持する**:
            * 保持期間（年、月、日）。
            * 保持期間の開始基準（作成日、最終更新日、ラベル付け日、イベント発生日）。
        * **アイテムを永久に保持する**。
        * **特定の期間が経過したらアイテムを削除するのみ**。
    * **保持期間終了後のアクション**:
        * アイテムを自動的に削除する。
        * 何もしない。
        * 廃棄レビューを開始する。
    * `[スクリーンショット：保持ポリシーの保持設定とアクション画面]`
* **原則**:
    * **保持の原則**: 複数のポリシーが同じコンテンツに適用され、保持期間が異なる場合、最も長い保持期間が優先されます。
    * **削除の原則**: 複数のポリシーが同じコンテンツに適用され、削除タイミングが異なる場合、最も早い削除が優先されます（ただし、保持ポリシーが優先される）。
    * 保持ポリシーとアイテム保持ラベルが競合する場合、通常はより明示的な設定（アイテム保持ラベルや、より長い保持期間）が優先されます。

### アイテム保持ラベル (Retention Labels)

* **目的**: 個々のアイテム（ドキュメント、メール）に対して、より詳細な保持・削除ルールを適用します。アイテム保持ポリシーよりもきめ細かい制御が可能です。
* **特徴**:
    * ユーザーが手動で適用、またはポリシーで自動適用（キーワード、機密情報の種類、学習可能な分類器などに基づく）。
    * アイテムがどこに移動してもラベル設定は維持されます。
* **設定項目 (ラベル作成時)**:
    * **名前と説明**。
    * **ファイル計画記述子 (File plan descriptors)**: (オプション) レコード管理のためのメタデータ（部門、カテゴリなど）。
    * **保持設定**: アイテム保持ポリシーと同様。
    * **保持期間終了後のアクション**: アイテム保持ポリシーと同様（廃棄レビューを含む）。
    * **アイテムをレコードとしてマークする (Mark item as a record)**: アイテムを変更・削除できないようにロックします（不変性）。規制レコードの管理に適しています。
    * **アイテムを規制レコードとしてマークする (Mark item as a regulatory record)**: レコードよりもさらに強力な不変性を提供し、一部の操作も制限されます。
    * `[スクリーンショット：アイテム保持ラベルの作成ウィザード - 保持設定画面]`
* **ラベルポリシーの発行**: 作成したアイテム保持ラベルをユーザーが利用できるように、または自動適用するために、ラベルポリシーを作成し、場所（Exchange, SharePointなど）を指定して発行します。
    * **手動適用**: ユーザーがOutlookやSharePointでアイテムにラベルを適用。
    * **自動適用**:
        * 特定の機密情報を含むアイテムに自動適用。
        * キーワードや検索可能なプロパティに一致するアイテムに自動適用。
        * イベントベースの保持（例: プロジェクト終了イベントが発生したら保持を開始）。
        * 学習可能な分類器 (Trainable Classifiers) を使用してコンテンツを分析し、自動適用。
    * `[スクリーンショット：アイテム保持ラベルポリシーの自動適用設定画面]`

### イベントベースの保持 (Event-based retention)

* **目的**: 特定のイベント（例: 従業員の退職、プロジェクトの完了、契約の終了）が発生した時点を起点として、関連するコンテンツの保持期間を開始します。
* **仕組み**:
    1.  アイテム保持ラベルを作成し、保持期間の開始を「イベント」に設定します。
    2.  イベントタイプを作成します。
    3.  対象のコンテンツにそのアイテム保持ラベルを適用します（手動または自動）。
    4.  イベントが発生した際に、Microsoft Purviewでそのイベントを作成し、関連するアセットID（従業員ID、プロジェクトIDなど）を指定します。
    5.  そのアセットIDを持つコンテンツの保持期間が開始されます。

### 廃棄レビュー (Disposition Review)

* **目的**: アイテム保持ポリシーまたはアイテム保持ラベルで設定された保持期間が終了したコンテンツを、自動的に削除するのではなく、レビュー担当者が確認し、削除を承認または延長できるようにします。
* **プロセス**:
    1.  保持期間が終了すると、コンテンツは廃棄レビュー待ちの状態になります。
    2.  レビュー担当者（指定されたユーザーやグループ）に通知が送信されます。
    3.  レビュー担当者はMicrosoft Purviewコンプライアンスポータルの `[データライフサイクル管理]` > `[廃棄]` で対象アイテムを確認し、以下のいずれかのアクションを実行します。
        * 削除を承認する。
        * 保持期間を延長する。
        * ラベルを変更する。
        * アイテムに別のレビュー担当者を割り当てる。
    * `[スクリーンショット：廃棄レビューのダッシュボードとレビュー対象アイテム画面]`

### ハンズオン演習アイデア

* **演習4.4: アイテム保持ポリシーの作成 (SharePointサイト)**
    1.  テスト用のSharePointチームサイトに対して、「作成日から3年間アイテムを保持し、その後自動的に削除する」というアイテム保持ポリシーを作成する。
    2.  ポリシーを静的スコープでそのサイトにのみ適用する。
    3.  (動作確認は長期間かかるため、設定内容の確認と、ポリシーがサイトに適用されているかの確認方法を学ぶ)。
* **演習4.5: アイテム保持ラベルの作成と手動適用**
    1.  「Project Alpha Documents - Retain 5 Years」という名前のアイテム保持ラベルを作成する。
        * 保持期間: 作成日から5年間。
        * 期間終了後: 廃棄レビューを開始する。
    2.  このラベルを含むラベルポリシーを作成し、テストユーザーのOneDriveアカウントに発行する。
    3.  テストユーザーのOneDriveにファイルをアップロードし、作成したアイテム保持ラベルを手動で適用してみる。
    4.  アイテムがレコードとしてマークされていないことを確認する（まだ編集可能であること）。
* **演習4.6: アイテムをレコードとしてマークするラベルの作成**
    1.  「Final Contract - Immutable Record」という名前のアイテム保持ラベルを作成する。
    2.  保持期間: 作成日から7年間。
    3.  期間終了後: 何もしない。
    4.  「アイテムをレコードとしてマークする」オプションを有効にする。
    5.  このラベルをテストユーザーのOneDriveに発行し、ファイルに適用する。
    6.  ラベル適用後、そのファイルが編集・削除できなくなる（または制限される）ことを確認する。

---

## 4.3 データ損失防止 (Microsoft Purview Data Loss Prevention - DLP)

### DLPの概要と目的

* **目的**: 組織内の機密情報（クレジットカード番号、マイナンバー、健康情報、知的財産など）が、誤ってまたは意図的に組織外へ漏洩するのを防ぎます。
* **仕組み**:
    * **ポリシーの定義**: 何を（機密情報）、どこで（場所）、どのような条件下で（条件）、どのように保護するか（アクション）を定義します。
    * **コンテンツ検査**: メール、ドキュメント、チャットメッセージなどのコンテンツをスキャンし、機密情報の種類、キーワード、正規表現、フィンガープリントなどに一致するかを判定します。
    * **アクションの実行**: ポリシー違反が検出された場合、アクセスのブロック、ユーザーへの通知（ポリシーヒント）、管理者へのアラート、暗号化などのアクションを自動的に実行します。
* **対象となる場所 (Locations)**:
    * Exchange Online メール
    * SharePoint Online サイト
    * OneDrive for Business アカウント
    * Microsoft Teams チャットおよびチャネルメッセージ
    * エンドポイント (Windows, macOS デバイス)
    * Microsoft Defender for Cloud Apps を介した非Microsoftクラウドアプリ
    * オンプレミスのリポジトリ (一部機能)
    * Power BI

### DLPポリシーの構成要素

* **ポリシー名と説明**。
* **管理単位 (オプション)**: ポリシーの管理スコープを限定。
* **場所 (Locations)**: ポリシーを適用するMicrosoft 365のサービスやデバイスを選択します。
    * 特定のSharePointサイトやOneDriveアカウント、配布グループなどを指定できます。
    * 除外設定も可能です。
    * `[スクリーンショット：DLPポリシーの場所の選択画面]`
* **条件 (Conditions)**: 何を検出するかを定義します。
    * **コンテンツに含まれるもの (Content contains)**:
        * **機密情報の種類 (Sensitive Information Types - SITs)**: Microsoftが提供する多数の組み込みSIT（例: クレジットカード番号、各国の個人識別番号）またはカスタムSITを使用します。
            * インスタンス数（例: クレジットカード番号が3つ以上）や信頼度レベル（一致の確からしさ）を指定できます。
        * **秘密度ラベル (Sensitivity labels)**: 特定の秘密度ラベルが付いたコンテンツ。
        * **アイテム保持ラベル (Retention labels)**: 特定のアイテム保持ラベルが付いたコンテンツ。
        * **学習可能な分類器 (Trainable classifiers)**: (Premium機能) 特定のカテゴリのコンテンツ（例: 契約書、ソースコード）を機械学習で識別。
    * **コンテンツが共有されている相手 (Content is shared from Microsoft 365 with people...)**:
        * 組織外のユーザー。
        * 組織内の特定のユーザー/グループ。
    * **その他の条件**: ファイル拡張子、ドキュメントプロパティなど。
    * `[スクリーンショット：DLPポリシーの条件設定画面 - 機密情報の種類の選択]`
* **アクション (Actions)**: 条件に一致した場合に実行する処理。
    * **コンテンツへのアクセスを制限するか、Microsoft 365 の場所にあるコンテンツを暗号化する**:
        * **すべての人**: 最も厳しい。
        * **組織外のユーザーのみ**: 一般的。
        * 特定のユーザー/グループ。
    * **ユーザー通知 (User notifications)**:
        * メール通知やポリシーヒント（OfficeアプリやOutlookで、ユーザーがポリシーに違反しそうになったときに表示されるリアルタイムのヒント）を送信します。
        * ポリシーヒントはカスタマイズ可能で、ユーザーがビジネス上の正当な理由がある場合に上書き（オーバーライド）するオプションを提供できます。
    * **インシデントレポート (Incident reports)**:
        * 管理者にメールでアラートを送信します。
        * アラートの重大度（低、中、高）を設定します。
        * イベントログに記録します。
    * **追加のアクション (Additional actions)**:
        * HTTPヘッダーの追加。
        * アクセス許可の削除。
    * `[スクリーンショット：DLPポリシーのアクション設定画面 - アクセス制限とユーザー通知]`
* **ポリシーモード**:
    * **すぐにオンにする**: ポリシーを即時有効化。
    * **最初にテストする**:
        * **ポリシーヒントなしでテストする (推奨されない)**: バックグラウンドで動作をテスト。
        * **テストモードでポリシーヒントを表示する**: ユーザーにヒントは表示されるが、アクションは強制されない。影響評価に有効。
    * **後でオンにする (無効のまま保存)**。

### 機密情報の種類 (Sensitive Information Types - SITs)

* **組み込みSIT**: Microsoftが提供する100種類以上の定義済みSIT。各国の個人識別番号、クレジットカード番号、銀行口座番号、健康記録番号など。
    * これらは正規表現、キーワード、チェックサム検証などを組み合わせて機密情報を検出します。
* **カスタムSIT**:
    * **キーワード/辞書**: 特定の単語やフレーズのリスト。
    * **正規表現**: パターンマッチング（例: 従業員IDのフォーマット）。
    * **関数**: （例: チェックサム検証）。
    * **完全なデータ一致 (Exact Data Match - EDM)**: (Premium機能) データベースなどからエクスポートした機密データの正確な値と照合します。非常に高い精度で誤検知を低減できます。
    * **ドキュメントフィンガープリンティング (Document fingerprinting)**: 標準的なフォーム（契約書テンプレートなど）を元にフィンガープリントを作成し、そのフォーム（または一部が変更されたもの）が使用されているドキュメントを検出します。
* **信頼度レベル (Confidence level)**: SITが検出した情報が、実際に機密情報である確からしさ（高、中、低）。DLPポリシーの条件で、特定の信頼度レベル以上を対象とすることができます。

### エンドポイントDLP (Endpoint DLP)

* **目的**: Windows 10/11 および macOS デバイス上の機密情報が、不正なアクティビティ（USBへのコピー、ネットワーク共有へのアップロード、印刷、クリップボードへのコピーなど）によって漏洩するのを防ぎます。
* **前提条件**:
    * デバイスがMicrosoft Defender for Endpointにオンボーディングされていること。
    * Microsoft Purview DLPライセンス。
* **動作**: デバイス上で実行されるアクティビティを監視し、DLPポリシーで定義された機密情報が含まれる場合にアクションを実行します。
* **制御可能なアクティビティ**:
    * USBなどのリムーバブルメディアへのコピー。
    * ネットワーク共有へのコピー。
    * 印刷。
    * クリップボードへのコピー。
    * 特定の（許可されていない）アプリへのアップロードやアクセス。
    * Bluetooth経由での転送。
    * RDP経由での転送。
* **アクション**: 監査のみ、警告、ブロック（上書きあり/なし）。
* **構成**: 通常のDLPポリシー作成時に、「デバイス」を場所として選択し、エンドポイント固有のアクティビティとアクションを設定します。
    * `[スクリーンショット：エンドポイントDLPのアクティビティとアクション設定画面]`

### ハンズオン演習アイデア

* **演習4.7: DLPポリシーの作成 (メールでのクレジットカード番号送信ブロック)**
    1.  「クレジットカード番号の外部送信ブロック」というDLPポリシーを作成する。
    2.  場所として「Exchange Online メール」を選択する。
    3.  条件として「コンテンツに機密情報の種類『クレジットカード番号』が1つ以上含まれ、かつ受信者が組織外である」と設定する。
    4.  アクションとして「メールの送信をブロックし、送信者にポリシーヒントで通知する。管理者にアラートを送信する」と設定する。
    5.  ポリシーを「最初にテストする（ポリシーヒント表示）」モードで有効にする。
    6.  テストユーザーで、外部のメールアドレス宛にダミーのクレジットカード番号を含むメールを送信しようとし、ポリシーヒントが表示されることを確認する。
    7.  モードを「すぐにオンにする」に変更し、再度メールを送信しようとするとブロックされることを確認する。
* **演習4.8: カスタム機密情報の種類の作成 (キーワードベース)**
    1.  「Project Falcon Confidential」というカスタム機密情報の種類を作成する。
    2.  キーワードとして「Project Falcon」「Falcon Secret」「Falcon FY2025 Plan」などを登録する。
    3.  このカスタムSITをDLPポリシーの条件として使用できることを確認する。
* **演習4.9: エンドポイントDLPの動作確認 (シミュレーション)**
    * (環境があれば) エンドポイントDLPポリシーで「USBデバイスへの機密ファイルコピーをブロック」する設定を行う。
    * 機密情報（例: クレジットカード番号を含むファイル）をUSBにコピーしようとするとブロックされることを確認する。

---

## 4.4 インサイダーリスク管理 (Microsoft Purview Insider Risk Management)

### インサイダーリスク管理の概要と目的

* **目的**: 悪意のある、または不注意な内部関係者（従業員、元従業員、請負業者、パートナーなど）によって引き起こされる可能性のあるリスク（データの盗難、機密情報の漏洩、セキュリティポリシー違反など）を特定、検出し、調査し、対処するためのソリューションです。
* **アプローチ**:
    * ユーザーアクティビティログ（Microsoft 365サービス、エンドポイントなど）や、オプションで人事システムなど外部からのシグナルを相関分析します。
    * 機械学習を活用して、通常の行動パターンから逸脱するリスクの高いアクティビティを特定します。
    * プライバシーを重視し、デフォルトでユーザー名を匿名化（仮名化）して表示するなどの機能を持ちます。
* **主なユースケース**:
    * 退職予定者によるデータの持ち出し。
    * 不満を持つ従業員による破壊行為や情報漏洩。
    * 不注意による機密情報の誤送信や不適切な共有。
    * セキュリティポリシー違反（例: 未承認のクラウドストレージ利用）。

### インサイダーリスク管理ポリシーの構成

* **アクセス場所**: Microsoft Purview コンプライアンスポータル > `[インサイダーリスク管理]`。
* **ポリシーテンプレート**: 一般的なリスクシナリオに基づいたテンプレートが提供されています。
    * データ盗難 (Data theft by departing users)
    * データ漏洩 (Data leaks)
    * セキュリティポリシー違反 (Security policy violations)
    * リスクの高いユーザーによるデータ漏洩 (Data leaks by risky users)
    * 問題のあるユーザーによるデータ漏洩 (Data leaks by disgruntled users)
    * `[スクリーンショット：インサイダーリスク管理ポリシーテンプレート選択画面]`
* **ポリシー設定の主要項目**:
    * **名前と説明**。
    * **スコープ**:
        * **対象ユーザー**: すべてのユーザー、または特定のユーザーグループ。
        * **ポリシーをトリガーするイベント**:
            * **退職**: (オプション) 人事コネクタと連携し、退職日情報をトリガーとして使用。
            * **パフォーマンス改善計画**: (オプション) 人事コネクタ。
            * **高リスク**: (オプション) Defender for Endpointやサードパーティからのリスクシグナル。
    * **監視するアクティビティとインジケーター**:
        * **Microsoft 365の場所**: SharePoint, Exchange, Teams, OneDriveなど。
        * **アクティビティの種類**: ファイルのダウンロード、外部共有、メール送信、USBへのコピー、印刷、個人クラウドストレージへのアップロード、機密度の低い場所へのファイル移動など、多数のインジケーターから選択。
        * **しきい値**: 通常とは異なる量のアクティビティを検出するためのしきい値（例: 1日に100MB以上のファイルをダウンロード）。
        * **インテリジェント検出**: 機械学習による異常検知。
    * **検出オプション**:
        * リスクスコアのブースティング（特定のインジケーターの重要度を上げる）。
        * ファイルアクティビティのシーケンス検出。
    * **アラートとしきい値**: アラートを生成するリスクスコアのしきい値を設定。
    * `[スクリーンショット：インサイダーリスク管理ポリシーのアクティビティ選択画面]`
* **プライバシー**: デフォルトでは、アラートやケース内のユーザー情報は匿名化（仮名化）されています。権限を持つアナリストのみが実名を確認できます。

### アラートのトリアージとケース管理

* **アラートダッシュボード**: ポリシーによって生成されたアラートの一覧。リスクスコア、関連ユーザー、トリガーとなったアクティビティなどが表示されます。
    * `[スクリーンショット：インサイダーリスク管理アラートダッシュボード]`
* **アラートのトリアージ**: アナリストはアラートを確認し、さらなる調査が必要かどうかを判断します。
    * **ユーザーアクティビティレポート**: 特定のユーザーのリスク関連アクティビティの時系列表示。
    * **ファイルアクティビティ**: 関連するファイルの機密度やDLPポリシー違反の有無。
* **ケースへの昇格**: 詳細な調査が必要なアラートは「ケース」に昇格させ、法務部門や人事部門と連携して対応を進めます。
* **ケース管理**:
    * ケースノートの記録。
    * 関連するコンテンツの収集とレビュー (eDiscoveryと連携)。
    * 関係者への通知。
    * 対応状況の追跡。

### ハンズオン演習アイデア

* **演習4.10: インサイダーリスク管理ポリシーの作成 (データ盗難シナリオ)**
    1.  (ライセンスがあれば) インサイダーリスク管理で、「退職するユーザーによるデータ盗難」ポリシーテンプレートを使用して新しいポリシーを作成する。
    2.  スコープとして、特定のテストユーザー（退職予定者と仮定）を指定する。
    3.  監視するアクティビティとして、「SharePointからの大量ダウンロード」「個人クラウドストレージへのアップロード」「USBへのファイルコピー」などを選択する。
    4.  アラートのしきい値を設定する。
    5.  (実際のトリガーイベントを起こすのは難しいため、ポリシー設定の確認と、どのようなインジケーターが利用可能かを理解する)。
* **演習4.11: インサイダーリスク管理のアラートとユーザーアクティビティの確認 (デモデータがあれば)**
    * Microsoftが提供するデモ環境やドキュメントのスクリーンショットを参考に、インサイダーリスクのアラートがどのように表示され、ユーザーアクティビティレポートでどのような情報が確認できるかを理解する。
    * 匿名化機能がどのように動作するかを把握する。

---

## 4.5 コミュニケーションコンプライアンス (Microsoft Purview Communication Compliance)

### コミュニケーションコンプライアンスの概要と目的

* **目的**: 組織内のコミュニケーション（メール、Teamsチャット/チャネル、Yammerなど）におけるポリシー違反（不適切な行動、嫌がらせ、差別的発言、機密情報の共有、規制対象のやり取りなど）を検出し、調査し、修復するためのソリューションです。
* **主なユースケース**:
    * 企業の行動規範や倫理規定の遵守。
    * 業界規制（FINRA、SECなど）への対応。
    * 職場環境の健全化。
    * 機密情報や顧客情報の不適切な共有の防止。
* **仕組み**:
    * ポリシーで監視対象のユーザー、コミュニケーションチャネル、検出条件（キーワード、分類子、条件付き設定）を指定します。
    * 条件に一致したメッセージがキャプチャされ、指定されたレビュアーが内容を確認し、適切な対応（タグ付け、エスカレーション、ユーザーへの通知など）を行います。
* **プライバシーの考慮**: レビュアーの権限管理、匿名化オプション。

### コミュニケーションコンプライアンスポリシーの構成

* **アクセス場所**: Microsoft Purview コンプライアンスポータル > `[コミュニケーションコンプライアンス]`。
* **ポリシーテンプレート**:
    * 不適切なコンテンツの監視。
    * 機密情報の監視。
    * 規制コンプライアンスの監視。
    * またはカスタムポリシーを作成。
* **ポリシー設定の主要項目**:
    * **名前と説明**。
    * **監視対象ユーザー/グループ**: ポリシーの対象となるコミュニケーションの参加者。
    * **監視対象の場所**: Exchangeメール、Microsoft Teams、Yammer、サードパーティソース（コネクタ経由）。
    * **レビュー担当者**: キャプチャされたメッセージを確認する権限を持つユーザーやグループ。
    * **条件と割合**:
        * **キーワード/辞書**: 特定の単語やフレーズを含むメッセージを検出。
        * **機密情報の種類 (SITs)**。
        * **秘密度ラベル**。
        * **アイテム保持ラベル**。
        * **学習可能な分類器**: 嫌がらせ、冒涜的表現、脅迫などを検出する組み込みの分類器や、カスタム分類器。
        * **添付ファイルの光学式文字認識 (OCR)**: 画像内のテキストもスキャン。
        * **レビューするコンテンツの割合**: すべてのメッセージをレビューするか、特定の割合をサンプリングするか。
    * **アクション**: メッセージがポリシーに一致した場合の自動タグ付けなど。
    * `[スクリーンショット：コミュニケーションコンプライアンスポリシーの条件設定画面]`

### メッセージのレビューと修復

* **保留中のアイテム**: レビュアーは、自分に割り当てられたポリシーに一致したメッセージをダッシュボードで確認します。
    * `[スクリーンショット：コミュニケーションコンプライアンスのレビューインターフェース]`
* **レビューオプション**:
    * **メッセージの表示**: 会話のコンテキスト全体を表示可能。
    * **タグ付け**: 事前定義されたタグ（準拠、非準拠、疑わしいなど）やカスタムタグを付与。
    * **コメントの追加**。
    * **エスカレーション**: 他のレビュー担当者や管理者にエスカレーション。
    * **ユーザーへの通知**: (オプション) ポリシー違反についてユーザーに教育的な通知を送信。
    * **解決済みとしてマーク**: レビューが完了したアイテム。
* **レポート**: ポリシーのヒット数、レビュー状況、傾向などを把握できます。

### ハンズオン演習アイデア

* **演習4.12: コミュニケーションコンプライアンスポリシーの作成 (不適切コンテンツ監視シナリオ)**
    1.  (ライセンスがあれば) コミュニケーションコンプライアンスで、「不適切なコンテンツの監視」テンプレートを使用して新しいポリシーを作成する。
    2.  監視対象ユーザーとして、特定のテストユーザーグループを指定する。
    3.  監視対象の場所として、Microsoft Teamsチャットを選択する。
    4.  レビュー担当者として、自分自身（またはテスト管理者アカウント）を指定する。
    5.  条件として、組み込みの「冒涜的表現」分類器を選択する。
    6.  レビューするコンテンツの割合を100%に設定する。
    7.  (実際の不適切コンテンツを生成するのは避けるため、ポリシー設定の確認と、分類器の種類を理解する)。
* **演習4.13: コミュニケーションコンプライアンスのレビューインターフェース確認 (デモデータがあれば)**
    * Microsoftが提供するデモ環境やドキュメントのスクリーンショットを参考に、レビュー担当者がメッセージを確認し、タグ付けやエスカレーションを行うインターフェースがどのようになっているかを理解する。

---

## 4.6 電子情報開示 (Microsoft Purview eDiscovery)

### eDiscoveryの概要と目的

* **目的**: 訴訟、内部調査、規制当局への対応など、法的な情報開示要求（ディスカバリ）に備えて、関連する電子的に格納された情報 (ESI) を特定、収集、処理、レビュー、分析、エクスポートするための一連のツールとプロセスを提供します。
* **主なステップ (EDRM - Electronic Discovery Reference Model に準拠)**:
    1.  **識別 (Identification)**: 関連する可能性のあるデータソースと情報を特定。
    2.  **保存 (Preservation)**: 関連データを変更・削除から保護（法的ホールド）。
    3.  **収集 (Collection)**: 関連データを集中的な場所に収集。
    4.  **処理 (Processing)**: 収集したデータをレビュー可能な形式に変換（重複排除、インデックス作成など）。
    5.  **レビュー (Review)**: 収集したデータの内容を確認し、関連性、機密性、特権などを判断。
    6.  **分析 (Analysis)**: データ間の関連性やパターンを分析。
    7.  **作成 (Production)**: レビュー済みの関連データを、要求元に提出できる形式でエクスポート。
    8.  **提示 (Presentation)**: 最終的な成果物を提示。
* **Microsoft Purview eDiscoveryのソリューション**:
    * **eDiscovery (Standard) (旧コンテンツ検索とeDiscoveryケース)**: 基本的な検索、エクスポート、法的ホールド機能。小規模なケースや初期調査に適しています。
    * **eDiscovery (Premium) (旧Advanced eDiscovery)**: Standardの機能に加え、より高度な分析（テーマ分析、重複検出、メールスレッド分析）、カストディアン管理、レビューセット、大容量データ処理など、エンドツーエンドのeDiscoveryワークフローをサポートします。大規模で複雑なケースに適しています。

### eDiscovery (Standard)

* **コンテンツ検索 (Content Search)**:
    * **機能**: Exchangeメールボックス、SharePointサイト、OneDriveアカウント、Teamsメッセージ、Yammerなど、Microsoft 365全体のコンテンツをキーワード、日付範囲、送信者/受信者、ファイルタイプなどの条件で検索します。
    * **利用シーン**: 特定の情報を見つけ出すための初期調査、DLPインシデント調査、データ整理など。
    * **結果**: 一致したアイテムの数、場所、プレビューなどを確認できます。結果をエクスポートすることも可能です。
    * `[スクリーンショット：コンテンツ検索の検索条件設定画面と結果表示画面]`
* **eDiscovery (Standard) ケース**:
    * **機能**: 特定の調査案件（ケース）を作成し、関連するコンテンツ検索、法的ホールド、エクスポートをまとめて管理します。
    * **法的ホールド (Legal Hold / In-Place Hold)**: ケースに関連する可能性のあるコンテンツ（メールボックス全体、サイト全体、または特定の検索条件に一致するアイテム）を、ユーザーによる変更・削除から保護します。アイテムは元の場所に保持されつつ、裏でコピーが保持されます。
        * `[スクリーンショット：eDiscovery Standardケースでの法的ホールド設定画面]`
    * **エクスポート**: 検索結果やホールド対象のアイテムをPSTファイル、個別のファイル形式などでエクスポートします。エクスポート時に重複排除やレポート生成も可能です。

### eDiscovery (Premium)

* **主な追加機能**:
    * **カストディアン管理**: ケースに関連する主要な人物（カストディアン）を指定し、その人物のデータソース（メールボックス、OneDriveなど）をケースに簡単に追加・管理できます。
    * **高度なインデックス作成**: より多くのファイルタイプをサポートし、インデックスエラーの修復も容易です。
    * **レビューセット (Review sets)**: 収集したデータをレビューセットに追加し、タグ付け、注釈付け、リダクション（墨塗り）、フィルタリング、検索などのレビュー作業を効率的に行えます。
        * `[スクリーンショット：eDiscovery Premiumのレビューセットインターフェース]`
    * **分析機能**:
        * **テーマ分析 (Themes)**: ドキュメント内の主要なテーマを自動的に識別。
        * **重複検出 (Near duplicates / Exact duplicates)**: 重複または類似したドキュメントを特定し、レビュー対象を削減。
        * **メールスレッド分析 (Email threading)**: メールの一連のやり取りをまとめて表示。
        * **関連性分析 (Relevance - プレビュー)**: 機械学習を使用して、レビュー担当者の判断に基づいてドキュメントの関連性を予測。
    * **エクスポートの強化**: より詳細なエクスポートオプションとレポート。
    * **訴訟ホールド通知**: カストディアンに法的ホールドが適用されたことを通知する機能。
* **ワークフロー**:
    1.  ケースを作成。
    2.  データソース（カストディアン、非カストディアンの場所）を特定し、追加。
    3.  必要に応じてデータソースに法的ホールドを適用。
    4.  データソースから関連データを収集し、レビューセットに追加。
    5.  レビューセット内でデータを検索、フィルタリング、分析、レビュー、タグ付け。
    6.  関連性のあるアイテムをエクスポート。

### ハンズオン演習アイデア

* **演習4.14: コンテンツ検索の実行**
    1.  Microsoft Purview コンプライアンスポータルでコンテンツ検索を開く。
    2.  特定のキーワード（例: 「Project Falcon」）、特定の日付範囲、特定の送信者（テストユーザー）を指定して、ExchangeメールボックスとSharePointサイトを対象に検索を実行する。
    3.  検索結果の統計（アイテム数、場所など）を確認し、一部アイテムをプレビューしてみる。
    4.  検索結果をエクスポートするオプションを確認する（実際のエクスポートは時間がかかる場合あり）。
* **演習4.15: eDiscovery (Standard) ケースの作成と法的ホールド**
    1.  eDiscovery (Standard) で新しいケースを作成する。
    2.  ケースにテストユーザーのメールボックスとOneDriveアカウントをデータソースとして追加する。
    3.  これらのデータソースに対して法的ホールドを作成し、有効化する。
    4.  （シミュレーション）テストユーザーがメールやファイルを削除しても、ホールドによって保持されることを理解する。
* **演習4.16: eDiscovery (Premium) の機能確認 (概念理解・デモ)**
    * (P2ライセンス環境があれば) eDiscovery (Premium) でケースを作成し、カストディアンを追加する手順を確認する。
    * データをレビューセットに追加し、レビューセット内で利用可能なフィルタリング、検索、タグ付け、分析（テーマ、重複など）の機能がどのようなものかを見てみる。
    * Microsoft Learnのドキュメントやデモ動画を参考に、eDiscovery (Premium) のエンドツーエンドのワークフローを理解する。

---

## 4.7 監査ログ (Microsoft Purview Audit)

### 監査ログの概要と目的

* **目的**: Microsoft 365 テナント内で実行されたユーザーアクティビティおよび管理者アクティビティを記録し、セキュリティインシデントの調査、コンプライアンス監査、トラブルシューティングなどに活用します。
* **記録されるアクティビティの例**:
    * **ユーザーアクティビティ**:
        * ファイルの表示、編集、削除、共有（SharePoint, OneDrive, Teams）。
        * メールの送信、受信、削除（Exchange）。
        * Teamsチャットの送信、会議への参加。
        * Microsoft Entra IDへのサインイン。
    * **管理者アクティビティ**:
        * ユーザーやグループの作成・変更・削除。
        * ポリシー（DLP, 保持, 条件付きアクセスなど）の作成・変更・削除。
        * 管理者ロールの割り当て変更。
        * eDiscovery検索の実行。
* **監査の有効化**:
    * **Audit (Standard)**: 多くの組織でデフォルトで有効になっていますが、明示的に有効化が必要な場合もあります。
    * **Audit (Premium)**: (Premiumライセンス) より長いログ保持期間、インテリジェントな分析、より多くの監査イベントなどの追加機能を提供します。
* **アクセス場所**: Microsoft Purview コンプライアンスポータル > `[監査]`。
    * `[スクリーンショット：監査ログ検索のメイン画面]`

### 監査ログの検索

* **検索条件**:
    * **アクティビティ**: 特定のアクティビティ名（例: `FileDeleted`, `UserLoggedIn`, `MailItemsAccessed`）またはすべてのアクティビティ。アクティビティピッカーで選択可能。
    * **開始日と終了日**: 検索対象の期間。Standardでは通常90日間（Exchangeメールボックスアクティビティは180日間）、Premiumでは1年間またはそれ以上（アドオンライセンスによる）。
    * **ユーザー**: 特定のユーザー（複数指定可）またはすべてのユーザー。
    * **ファイル、フォルダー、またはサイト**: 特定のSharePointサイトURL、ファイル名、フォルダー名。
    * **IPアドレス**: (一部アクティビティ)
    * **レコードタイプ**: (一部アクティビティ)
* **検索の実行**: 条件を指定して検索を実行すると、一致する監査レコードの一覧が表示されます。
* **検索結果の確認**:
    * 各レコードには、日時、IPアドレス、実行したユーザー、アクティビティ、対象アイテム、詳細情報などが含まれます。
    * 結果はフィルタリングしたり、並べ替えたりできます。
    * `[スクリーンショット：監査ログ検索結果の表示例]`
* **結果のエクスポート**: 検索結果をCSVファイルとしてエクスポートし、Excelなどで詳細な分析を行うことができます。

### 監査ログの活用シナリオ

* **セキュリティインシデント調査**:
    * 不正アクセスが疑われるアカウントのサインイン履歴や操作履歴の確認。
    * データ漏洩インシデント発生時のファイルアクセス履歴や外部共有履歴の追跡。
    * マルウェア感染後の不審なアクティビティの特定。
* **コンプライアンス監査**:
    * 特定の規制要件（例: GDPR, HIPAA）で求められるアクセス記録や変更記録の提出。
    * 内部統制の有効性の検証。
* **トラブルシューティング**:
    * ユーザーが「ファイルが消えた」「設定が変わった」と報告した場合の原因究明。
    * 管理者による意図しない設定変更の特定。
* **管理者の不正操作の抑止**: 監査ログが記録されていることを周知することで、不正行為を抑止する効果も期待できます。

### Audit (Premium) の追加機能 (参考)

* **より長い監査ログ保持期間**: デフォルトで1年間、アドオンで最大10年間。
* **より多くの監査イベント**: Microsoft Teamsリアクション、検索クエリなど、より詳細なアクティビティを記録。
* **高帯域幅アクセス**: 大量の監査ログを効率的にエクスポートするためのAPI。
* **インテリジェントな分析**: (一部機能) 特定のイベントシーケンスの検出など。

### ハンズオン演習アイデア

* **演習4.17: 監査ログの検索実行 (基本)**
    1.  Microsoft Purview コンプライアンスポータルの監査ログ検索を開く。
    2.  過去24時間以内に、特定のテストユーザーが実行した「ファイルアクセス」アクティビティを検索してみる。
    3.  検索結果が表示されたら、日時、アクティビティの種類、対象ファイル名などを確認する。
* **演習4.18: 管理者アクティビティの監査**
    1.  監査ログ検索で、過去7日間に実行された「管理者ロールの割り当て変更」や「ポリシーの作成/変更」などの管理者アクティビティを検索してみる。
    2.  どの管理者がいつどのような変更を行ったかの記録が残っていることを確認する。
* **演習4.19: 監査ログのエクスポートと確認**
    1.  小規模な監査ログ検索（例: 特定のユーザーの直近1時間のアクティビティ）を実行する。
    2.  検索結果をCSVファイルとしてエクスポートする。
    3.  エクスポートされたCSVファイルをExcelなどで開き、どのような列（情報）が含まれているかを確認する。特に `AuditData` 列（JSON形式）に詳細情報が含まれていることを理解する。

---

## モジュール4 まとめ

このモジュールでは、Microsoft Purviewの主要なコンプライアンスソリューションについて学びました。

* **情報保護**: 秘密度ラベルによるデータの分類と保護。
* **データライフサイクル管理**: アイテム保持ポリシーとラベルによるデータの保持と削除。
* **データ損失防止(DLP)**: 機密情報の漏洩防止。
* **インサイダーリスク管理**: 内部リスクの検出と対応。
* **コミュニケーションコンプライアンス**: コミュニケーションポリシー違反の監視。
* **eDiscovery**: 法的調査のためのデータ検索と収集。
* **監査ログ**: アクティビティの追跡と調査。

これらの機能を組み合わせることで、組織はコンプライアンス体制を強化し、データガバナンスを向上させることができます。各機能の設定オプションは多岐にわたるため、組織のポリシーと要件に基づいて慎重に計画・構成することが重要です。

---
